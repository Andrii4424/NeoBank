<section class="object-info-card">
    @if(userCard$ | async; as card){
        <table class="info-table">
            <tr class="colored">
                <td>Field</td>
                <td>Value</td>
            </tr>
            <tr>
                <td>Card tariffs</td>
                <td><a [routerLink]="['/cards/info/', card.cardTariffId]">{{card.cardTariffs.cardName}}</a></td>
            </tr>
            <tr class="colored">
                <td>Card Number</td>
                <td>{{card.cardNumber}}</td>
            </tr>
            <tr>
                <td>Expiry Date</td>
                <td>{{card.expiryDate}}</td>
            </tr>
            <tr class="colored">
                <td>Payment System</td>
                <td>
                    @if (card.chosedPaymentSystem === PaymentSystem.Mastercard) {
                        <span>Mastercard</span>
                    }
                    @else if (card.chosedPaymentSystem === PaymentSystem.Visa) {
                        <span>Visa</span>
                    }
                </td>
            </tr>
            <tr>
                <td>Currency</td>
                <td>
                    @switch (card.chosenCurrency) {
                        @case(Currency.UAH){
                            <span>UAH</span>
                        }
                        @case(Currency.EUR){
                            <span>EUR</span>
                        }
                        @case(Currency.USD){
                            <span>USD</span>
                        }
                        @default {}
                    }
                </td>
            </tr>
            <tr class="colored">
                <td>Pin</td>
                <td>{{card.pin}}</td>
            </tr>
            <tr>
                <td>Card Status</td>
                <td>
                    @switch (card.status) {
                        @case(CardStatus.Active){
                            <span>Active</span>
                        }
                        @case(CardStatus.Expired){
                            <span>Expired</span>
                        }
                        @case(CardStatus.Blocked){
                            <span>Blocked</span>
                        }
                        @default {}
                    }
                </td>
            </tr>
            <tr class="colored">
                <td>CVV</td>
                <td>{{card.cvv}}</td>
            </tr>
            <tr>
                <td>Balance 
                    @if(card.cardTariffs.type===CardType.Credit){
                        <span>(without credit limit)</span>
                    }
                </td>
                <td>
                    <span>{{card.balance}}{{getCurrencySymbol()}}</span>
                </td>
            </tr>
            <tr class="colored">
                <td>Credit Limit</td>
                <td>{{card.creditLimit}}{{getCurrencySymbol()}}
                </td>
            </tr>
        </table>

        <div class="card-action-buttons">
            <button class="green-btn" (click)="openAddFounds()">ðŸ’³ Add Funds</button>
            <button class="blue-btn" (click)="openPin()">ðŸ”‘ Change PIN</button>
            @if(card.cardTariffs.type === CardType.Credit){
                <button class="blue-btn" (click)="openCreditLimit()">ðŸ“ˆ Change Credit Limit</button>
            }
            <button class="blue-btn">ðŸ”„ Card Reissue</button>
            @if(card.status===CardStatus.Active){
                <button class="red-btn">ðŸ”’ Block</button>
            }
            @else if(card.status===CardStatus.Blocked){
                <button class="red-btn">ðŸ”“ Unblock</button>
            }
        </div>
    }
</section>

@if(openAddFoundsWindow()){
    <app-modal-input-window
    headerMessage="Add Funds"
    subTittleMessage="To proceed, enter a value from 0 to 200 000 000 and press the Confirm button."
    (closeWindow)="closeModalWindow()"
    (submitValue)="addFunds($event)"
    [isAddFunds]="true"
    >
    </app-modal-input-window>
}
@if(openAddChangePinWindow()){
    <app-modal-input-window
    headerMessage="Change PIN"
    subTittleMessage="Please enter a new PIN-code."
    (closeWindow)="closeModalWindow()"
    (submitPin)="changePin($event)"
    [isChangePin]="true"
    >
    </app-modal-input-window>
}

@if(openChangeCreditLimit()){
    <app-modal-input-window
    headerMessage="Change Credit Limit"
    subTittleMessage="Please enter a new Credit Limit"
    (closeWindow)="closeModalWindow()"
    [startCreditLimitValue]="startCreditLimitValue"
    [creditLimitParams]="exchangeParams"
    [isChangeCreditLimit]="true"
    (submitCreditLimit)="changeCreditLimit($event)"
    >
    </app-modal-input-window>
}

<!--Status messages-->
@if(successAddingFunds()){
    <app-success-message
    message="Success!"
    secondMessage="Successful card replenishment!">
    </app-success-message>
}
@if(openSuccessMessage()){
    <app-success-message
    message="Success!"
    [secondMessage]="successMessage">
    </app-success-message>
}

@if(openErrorMessage()){
    <app-error-message
    message="Error"
    [secondMessage]="errorMessage">
    </app-error-message>
}

