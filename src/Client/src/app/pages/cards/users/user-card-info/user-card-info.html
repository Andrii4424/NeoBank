@if(userCard$ | async; as card){
    <header>
        <h1 class="heading">{{'CardInformation' |translate}}</h1>
    </header>

    <section class="object-info-card">

        <table class="info-table">
            <tr class="colored">
                <td>{{'Field' |translate}}</td>
                <td>{{'Value' |translate}}</td>
            </tr>
            <tr>
                <td>{{'CardTariffs' |translate}}</td>
                <td><a [routerLink]="['/cards/info/', card.cardTariffId]">{{card.cardTariffs.cardName}}</a></td>
            </tr>
            <tr class="colored">
                <td>{{'CardNumber' |translate}}</td>
                <td>{{card.cardNumber}}</td>
            </tr>
            <tr>
                <td>{{'ExpiryDate' |translate}}</td>
                <td>{{card.expiryDate}}</td>
            </tr>
            <tr class="colored">
                <td>{{'PaymentSystem' |translate}}</td>
                <td>
                    @if (card.chosedPaymentSystem === PaymentSystem.Mastercard) {
                        <span>Mastercard</span>
                    }
                    @else if (card.chosedPaymentSystem === PaymentSystem.Visa) {
                        <span>Visa</span>
                    }
                </td>
            </tr>
            <tr>
                <td>{{'Currency' |translate}}</td>
                <td>{{getCurrencyText()}}</td>
            </tr>
            <tr class="colored">
                <td>{{'Pin' |translate}}</td>
                <td>{{card.pin}}</td>
            </tr>
            <tr>
                <td>{{'CardStatus' |translate}}</td>
                <td>
                    @switch (card.status) {
                        @case(CardStatus.Active){
                            <span>{{'Active' |translate}}</span>
                        }
                        @case(CardStatus.Expired){
                            <span>{{'Expired' |translate}}</span>
                        }
                        @case(CardStatus.Blocked){
                            <span>{{'Blocked'|translate}}</span>
                        }
                        @default {}
                    }
                </td>
            </tr>
            <tr class="colored">
                <td>CVV</td>
                <td>{{card.cvv}}</td>
            </tr>
            <tr>
                <td>{{'Balance' |translate}} 
                    @if(card.cardTariffs.type===CardType.Credit){
                        <span>{{'withoutCreditLimit' |translate}}</span>
                    }
                </td>
                <td>
                    <span>{{card.balance}}{{getCurrencySymbol()}}</span>
                </td>
            </tr>
            <tr class="colored">
                <td>{{'CreditLimit' |translate}}</td>
                <td>{{card.creditLimit}}{{getCurrencySymbol()}}
                </td>
            </tr>
        </table>

        <div class="card-action-buttons">
            <button class="green-btn" (click)="openAddFounds()">💳 {{'AddFunds' |translate}}</button>
            <button class="blue-btn" (click)="openPin()">🔑 {{'ChangePin' |translate}}</button>
            @if(card.cardTariffs.type === CardType.Credit){
                <button class="blue-btn" (click)="openCreditLimit()">📈 {{'ChangeCreditLimit' |translate}}</button>
            }
            <button class="blue-btn" (click)="reissueCard()">🔄 {{'ReissueCard' |translate}}</button>
            @if(card.status===CardStatus.Active){
                <button class="red-btn" (click)="blockCard()">🔒 {{'Block' |translate}}</button>
            }
            @else if(card.status===CardStatus.Blocked){
                <button class="red-btn" (click)="unblockCard()">🔓 {{'Unblock' |translate}}</button>
            }
            <button class="red-btn" (click)="closeCard()">🗑️ {{'CloseCard' |translate}}</button>
        </div>
    </section>
    <header>
        <h1 class="heading mt-8">{{'Transactions' |translate}}</h1>
    </header>
}
@else {
    <app-loading></app-loading>
}




<app-transactions
[cardCurrencySymbol]="getCurrencySymbol()"
[cardCurrencyText]="getCurrencyText()"
></app-transactions>


@if(openAddFoundsWindow()){
    <app-modal-input-window
    [headerMessage]="'AddFunds' | translate"
    [subTittleMessage]="'AddFundsDescription'|translate"
    (closeWindow)="closeModalWindow()"
    (submitValue)="addFunds($event)"
    [isAddFunds]="true"
    >
    </app-modal-input-window>
}
@if(openAddChangePinWindow()){
    <app-modal-input-window
    [headerMessage]="'ChangePin'|translate"
    [subTittleMessage]="'EnterPin'|translate"
    (closeWindow)="closeModalWindow()"
    (submitPin)="changePin($event)"
    [isChangePin]="true"
    >
    </app-modal-input-window>
}

@if(openChangeCreditLimit()){
    <app-modal-input-window
    [headerMessage]="'ChangeCreditLimit'|translate"
    [subTittleMessage]="'EnterCreditLimit'|translate"
    (closeWindow)="closeModalWindow()"
    [startCreditLimitValue]="startCreditLimitValue"
    [creditLimitParams]="exchangeParams"
    [isChangeCreditLimit]="true"
    (submitCreditLimit)="changeCreditLimit($event)"
    >
    </app-modal-input-window>
}

@if(openConfirmWindow()){
    <app-confirm-window
    [title]="actionTitle"
    [subtitle]="actionSubtitle"
    [action]="action"
    (confirmAction)="confirmAction()"
    (cancelAction)="cancelAction()"
    >
    </app-confirm-window>
}

<!--Status messages-->
@if(successAddingFunds()){
    <app-success-message
    [message]="'Success'|translate"
    [secondMessage]="'SuccessfulReplenishment'|translate">
    </app-success-message>
}
@if(openSuccessMessage()){
    <app-success-message
    [message]="'Success'|translate"
    [secondMessage]="successMessage">
    </app-success-message>
}

@if(openErrorMessage()){
    <app-error-message
    [message]="'Error' |translate"
    [secondMessage]="errorMessage">
    </app-error-message>
}
