version: '3.8'

services:
  bank-api:
    build: 
      context: .
      dockerfile: ./src/Services/Bank/API/Bank.API.WebUI/Dockerfile
    container_name: bank-api
    ports: 
      - 8080:8080
      - 8081:8081
    networks:
      - bank_network
    depends_on:
      - bank-mssql

  bank-mssql:
    image: mcr.microsoft.com/mssql/server:2019-CU24-ubuntu-20.04
    container_name: bank-mssql
    environment:
      - SA_PASSWORD=Strong44442424
      - ACCEPT_EULA=Y
    ports:
      - 1433:1433
    volumes:
      - mssql_data:/var/opt/mssql
      - D:\FullStack\Databases\Backups:/backups
    networks:
      - bank_network

  nginx:
    build: 
      context: .  
      dockerfile: ./nginx/Dockerfile
    container_name: bank-nginx
    ports:
      - "4200:80"
    depends_on:
      - bank-api
    networks:
      - bank_network

networks:
  bank_network: 
    driver: bridge
          

volumes:
  mssql_data: